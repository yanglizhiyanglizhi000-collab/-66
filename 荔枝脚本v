
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local function IsMobile()
    return UserInputService.TouchEnabled and not UserInputService.MouseEnabled
end

local function GetScreenSize()
    local viewport = workspace.CurrentCamera.ViewportSize
    return viewport.X, viewport.Y
end

local function GetAdaptiveSize()
    local screenWidth, screenHeight = GetScreenSize()
    local isMobile = IsMobile()

    if isMobile then

        local width = math.min(screenWidth * 0.85, 420)
        local height = math.min(screenHeight * 0.65, 500)
        return UDim2.new(0, width, 0, height)
    else

        local width = math.min(520, screenWidth * 0.8)
        local height = math.min(520 * 0.618, screenHeight * 0.8)
        return UDim2.new(0, width, 0, height)
    end
end

local function GetAdaptivePosition(size)
    local isMobile = IsMobile()

    if isMobile then

        return UDim2.new(0.5, -size.X.Offset/2, 0.5, -size.Y.Offset/2)
    else

        return UDim2.new(0, -size.X.Offset - 100, 0.5, -size.Y.Offset/2)
    end
end

local function GetGameListSize()
    local screenWidth, screenHeight = GetScreenSize()
    local isMobile = IsMobile()

    if isMobile then

        local width = math.min(screenWidth * 0.9, 380)
        local height = math.min(screenHeight * 0.8, 550)
        return UDim2.new(0, width, 0, height)
    else

        return UDim2.new(0, 450, 0, 600)
    end
end

local function GetDeveloperPageSize()
    local screenWidth, screenHeight = GetScreenSize()
    local isMobile = IsMobile()

    if isMobile then

        local width = math.min(screenWidth * 0.92, 400)
        local height = math.min(screenHeight * 0.85, 580)
        return UDim2.new(0, width, 0, height)
    else

        return UDim2.new(0, 600, 0, 520)
    end
end

local function cleanupAllGuis()
    for _, gui in pairs(playerGui:GetChildren()) do
        if gui.Name == "XiProLoader" or gui.Name == "XiProGameList" then
            gui:Destroy()
        end
    end
end

local function createParticle(parent)
    local particle = Instance.new("Frame")
    particle.Size = UDim2.new(0, math.random(2, 4), 0, math.random(2, 4))
    particle.Position = UDim2.new(math.random(0, 100)/100, 0, math.random(0, 100)/100, 0)
    particle.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
    particle.BackgroundTransparency = math.random(30, 70)/100
    particle.BorderSizePixel = 0
    particle.ZIndex = 6
    particle.Parent = parent
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0.5, 0)
    corner.Parent = particle
    spawn(function()
        while particle.Parent do
            local moveInfo = TweenInfo.new(math.random(20, 40)/10, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut)
            local newPos = UDim2.new(math.random(0, 100)/100, 0, math.random(0, 100)/100, 0)
            local moveTween = TweenService:Create(particle, moveInfo, {Position = newPos})
            moveTween:Play()
            wait(math.random(20, 40)/10)
        end
    end)
end

local function GetAsset(v)
    local b = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
    return game:GetService("HttpService"):JSONDecode(request({
        Url = v,
        Headers = {
            Authorization = "Bearer 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"
        }
    }).Body).content:gsub('[^'..b..'=]', ''):gsub('.', function(x)
        if (x == '=') then return '' end
        local r,f='',(b:find(x)-1)
        for i=6,1,-1 do r=r..(f%2^i-f%2^(i-1)>0 and '1' or '0') end
        return r;
    end):gsub('%d%d%d?%d?%d?%d?%d?%d?', function(x)
        if (#x ~= 8) then return '' end
        local c=0
        for i=1,8 do c=c+(x:sub(i,i)=='1' and 2^(8-i) or 0) end
        return string.char(c)
    end)
end

local function showLoadingAnimation(onComplete)
    cleanupAllGuis()

    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "XiProLoader"
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    screenGui.ResetOnSpawn = false
    screenGui.IgnoreGuiInset = true
    screenGui.Parent = playerGui

    local background = Instance.new("Frame")
    background.Size = UDim2.new(1, 0, 1, 0)
    background.Position = UDim2.new(0, 0, 0, 0)
    background.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    background.BackgroundTransparency = 0.3
    background.BorderSizePixel = 0
    background.ZIndex = 1
    background.Parent = screenGui

    local backgroundGradient = Instance.new("UIGradient")
    backgroundGradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(10, 15, 35)),
        ColorSequenceKeypoint.new(0.3, Color3.fromRGB(5, 8, 20)),
        ColorSequenceKeypoint.new(0.7, Color3.fromRGB(0, 0, 0)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(15, 20, 40))
    }
    backgroundGradient.Rotation = 45
    backgroundGradient.Parent = background

    spawn(function()
        while background.Parent do
            local rotateInfo = TweenInfo.new(12, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, 0, true)
            local rotateTween = TweenService:Create(backgroundGradient, rotateInfo, {Rotation = 135})
            rotateTween:Play()
            wait(12)
        end
    end)

    local mainContainer = Instance.new("Frame")
    local adaptiveSize = GetAdaptiveSize()
    mainContainer.Size = adaptiveSize
    mainContainer.Position = GetAdaptivePosition(adaptiveSize)
    mainContainer.BackgroundColor3 = Color3.fromRGB(18, 25, 45)
    mainContainer.BackgroundTransparency = 0.02
    mainContainer.BorderSizePixel = 0
    mainContainer.ZIndex = 3
    mainContainer.Parent = screenGui

    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0, 28)
    mainCorner.Parent = mainContainer

    local shadowStroke1 = Instance.new("UIStroke")
    shadowStroke1.Thickness = 20
    shadowStroke1.Color = Color3.fromRGB(0, 0, 0)
    shadowStroke1.Transparency = 0.95
    shadowStroke1.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    shadowStroke1.Parent = mainContainer

    local shadowStroke2 = Instance.new("UIStroke")
    shadowStroke2.Thickness = 12
    shadowStroke2.Color = Color3.fromRGB(0, 0, 0)
    shadowStroke2.Transparency = 0.8
    shadowStroke2.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    shadowStroke2.Parent = mainContainer

    local shadowStroke3 = Instance.new("UIStroke")
    shadowStroke3.Thickness = 6
    shadowStroke3.Color = Color3.fromRGB(0, 0, 0)
    shadowStroke3.Transparency = 0.6
    shadowStroke3.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    shadowStroke3.Parent = mainContainer

    local mainStroke = Instance.new("UIStroke")
    mainStroke.Thickness = 3
    mainStroke.Color = Color3.fromRGB(100, 150, 255
